<ng-container *ngIf="selectOptions && selectOptions | formlySelectOptions: field | async as opts">
  <ng-container *ngIf="!useFixedDisplay(opts); else fixedDisplay">
    <select
      [formControl]="formControl"
      [compareWith]="to.compareWith ? to.compareWith : defaultOptions.templateOptions.compareWith"
      [formlyAttributes]="field"
      class="form-control"
      [ngClass]="to.inputClass"
      [attr.data-testing-id]="field.key"
    >
      <ng-container *ngIf="to._flatOptions">
        <ng-container *ngFor="let opt of opts">
          <option [value]="opt.value" [disabled]="opt.disabled">
            {{ opt.label }}
          </option>
        </ng-container>
      </ng-container>
    </select>
  </ng-container>

  <ng-template #fixedDisplay>
    {{ getFixedOption(opts).label }}
  </ng-template>
</ng-container>
